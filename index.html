<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculator</title>
</head>
<body>
    <div id="display">0</div>
    <button id="num">0</button>
    <button id="num">1</button>
    <button id="num">2</button>
    <button id="num">3</button>
    <button id="num">4</button>
    <button id="num">5</button>
    <button id="num">6</button>
    <button id="num">7</button>
    <button id="num">8</button>
    <button id="num">9</button>
    <button id="num">.</button>
    <button id="operator">+</button>
    <button id="operator">-</button>
    <button id="operator">x</button>
    <button id="operator">/</button>
    <button id="equal">=</button>
    <button id="clear">clear</button>


    <script>
        // function add(num1, num2) {
        //     return num1 + num2;
        // }

        // function subtract(num1, num2) {
        //     return num1 - num2;
        // }

        // function multiply(num1, num2) {
        //     return num1 * num2;
        // }

        // function divide(num1, num2) {
        //     return num1 / num2;
        // }

        function operate(num1, num2, operator) {    // why not just do return num1 + num2 directly in operate function?
            switch(operator) {
                case '+':
                    return num1 + num2;
                    break;
                case '-':
                    return num1 - num2;
                    break;
                case '*':
                case 'x':
                    return num1 * num2;
                    break;
                case '/':
                    if (num2 === 0) {
                        return 'Universe imploding in 3, 2, 1...';
                    }
                    else {
                        return num1 / num2;
                    }
                    break;
            }
        }

        const buttons = document.querySelectorAll('button');
        const display = document.querySelector('#display');

        // I THINK HAVING ALL THESE GLOBAL VARIABLES IS BAD PRACTICE. TRY TO CLEAN THIS UP. I THINK THEY SHOULD LIVE WITHIN FUNCTIONS?

        let userNums = []; // Initializations are outside of event listener otherwise it gets overwritten each click.
        let userNumsJoined = [];
        let num1;   // Creating variables for all of these then overwriting their values within the if statements so they can be seen anywhere in the code.
        let num2;
        let operator;
        let operatorCount = 0;
        let userInput;
        let operatorPrev;

        buttons.forEach((btn) => {
            btn.addEventListener("click", (e) => {
                let target = e.target.innerText;
                let targetType = e.target.id;

                switch (targetType) {
                    case 'num':
                        userNums.push(target);
                        userInput = userNums.join('');
                        display.textContent = userInput;
                        break;
                    case 'operator':
                        operator = e.target.innerText;
                        operatorCount++;

                        if (operatorCount > 1) {
                            num2 = +userInput;  // Notice it's num2 =, not let num2 =. We are overwriting its value so it can be seen everywhere. // Unary + converts num1 from string to number
                            let result = operate(num1, num2, operatorPrev);

                            if (typeof result === 'number') {
                                display.textContent = Math.round(result * 100000) / 100000;
                            }

                            else {
                                display.textContent = result;
                            }

                            num1 = result;
                            operatorPrev = operator;
                        }

                        else {
                            // num1 = +userInput               
                            // display.textContent = num1;
                            // operatorPrev = operator;

                            if (!userNums.length) {             // Calc still works if user presses an 
                                num1 = 0                        // operator before any numbers. Just uses 
                                display.textContent = num1;     // 0 as starting value. Same behavior as
                                operatorPrev = operator;        // a normal calc.
                            }

                            else {                              // If user does press nums before an
                                num1 = +userInput               // operator, store those nums as num1.
                                display.textContent = num1;
                                operatorPrev = operator;
                            }
                        }

                        userNums = [];                          // Reset userNums array so more num1 
                        break;                                  // and num2 can be created.
                    case 'equal': 
                        if (typeof num1 === 'undefined') {      // Clear if equal is pressed before nums or operator
                             if (userNums.length) {             // NEED FIX IF USER PRESSES EQUAL OVER AND OVER
                                display.textContent = userInput;
                             }

                             else {
                                display.textContent = 0;
                             }
                            
                            // let clearBtn = document.querySelector('#clear'); // want nothing to happen not to clear.
                            //     let clickEvent = new Event('click');
                            //     clearBtn.dispatchEvent(clickEvent);
                            }    
                        
                        else {                              // If user did press nums or an operator first, assign a num2 and get a result.
                            userNums = [];
                            num2 = +userInput;

                            let equalResult = operate(num1, num2, operator);
                            
                            if (typeof equalResult === 'number') {  
                                display.textContent = Math.round(equalResult * 100000) / 100000;
                            }

                            else {  // Allows for snarky error message to show if user divides by 0 because the error message is a string.
                                display.textContent = equalResult;
                            }
                        }
                        break;
                    case 'clear':
                        num1 = undefined;
                        num2 = undefined;
                        userNums = [];
                        operatorCount = 0;
                        display.textContent = '0'; 
                };
            });
        });

// What happens if they press operators in a row? Overwrite somehow?
        // If statement?
        // Right now, do not have capability to overwrite one operator with another
        // But, my calc has the same behavior as the CALC YA LATER example in TOP.

    </script>
</body>
</html>